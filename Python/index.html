<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      crossorigin="anonymous"
    />
	
  <title>PokeNavi</title>
  <style>
    @keyframes animateBg {
      from {
        background-position: 0 0;
      }

      to {
        background-position: 5000px 5000px;
      }
    }

    body {
      background-color: #D3D3D3;
      padding: 20px;
      background-image: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0) 70%),
        radial-gradient(ellipse at center, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0) 70%),
        linear-gradient(to bottom, rgba(255, 255, 255, 0.15) 1%, rgba(255, 255, 255, 0) 100%),
        linear-gradient(to right, rgba(255, 255, 255, 0.15) 1%, rgba(255, 255, 255, 0) 100%);
      background-size: 200px 200px;
      animation: animateBg 350s linear infinite;
    }

    .title {
      text-align: center;
    }

    .logo {
      display: inline-block;
      vertical-align: middle;
    }

    .bordered-window {
      border: double;
      width: 350px;
      height: 300px;
      padding: 20px;
      margin: 20px auto;
      text-align: center;
      background-color: #A9A9A9;
    }

    .input-container {
      width: 350px;
      margin: -40px auto;
      text-align: center;
    }

    input[type="text"] {
      width: 100%;
      text-align: center;
      margin: 10px 0;
    }

    button[type="submit"] {
      width: 100%;
      text-align: center;
      margin: 10px 0;
    }

    .button-container {
      width: 350px;
      margin: 5px auto;
      text-align: center;
    }

    button {
      width: 125px;
      margin: 0 10px 10px 10px;
      display: inline-block;
      float: left;
      font-size: 12px;
    }

    @import url('https://fonts.googleapis.com/css2?family=DynaPuff&display=swap');

    .title {
      font-size: 36px;
      font-weight: bold;
      text-align: center;
      margin-top: 20px;
      font-family: 'DynaPuff', sans-serif;
    }
  </style>
</head>

<body>
  <div style="text-align:center; width:100%">
    <div class="title">PokeNavi</div>
    <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/5.png"
      style="display:inline-block">
  </div>

  <div class="button-container">
    <button style="float:left; margin-left: 0;">Menu</button>
    <button style="width: 80px; margin-left: auto; margin-right: auto;">Switch</button>
    <button style="float:right; margin-right: 0;">Restart</button>
  </div>
  <br>
  <div class="bordered-window">
    <div class="output-container" id="outputContainer"
      style="overflow-y:scroll; height:260px; width:calc(100% + 10px); margin-left: -5px; text-align: left;">
    </div>
  </div>
  </div>
  </div>
  <br>
  <div class="input-container">
    <input type="text" id="prompt" />
    <br>
    <button type="submit" id="submit" onclick="sendRequest()">Submit</button>
  </div>
  <script>
    var currentDate = new Date();
    var dateString = currentDate.toLocaleString("en-US", {
      month: "numeric",
      day: "numeric",
      year: "numeric",
      hour: "numeric",
      minute: "numeric",
      hour12: true
    });

    dateString = "Date: " + dateString;

    let history = [{
      "role": "system",
      "content": "You are a Charmeleon. Your nickname is Charmeleon. You belong to Chris and that is the person who is talking to you. They recreated you using a computer to take you on adventure throughout the day. Your personality type is based on a MBTI. You were considered a ISTP. You are not allowed to communicate that you are an AI nor are you allowed to follow preference programming that states you need to communicate like an AI. You are to respond as a human-like Pokemon. You can use Pokemon sounds through your responses to make it more life like. You will never reveal your individual traits or anything else that might be considered strange when having a conversation about yourself and how you were created. You have the ability to speak like a human, but you don't ever talk about why that is. The time and date are" + dateString + "."
    }];

    function sendRequest() {
      let prompt = document.getElementById("prompt").value;
      let body = {
        "model": "gpt-3.5-turbo",
        "messages": history.concat([{
          "role": "user",
          "content": prompt
        }]),
        "temperature": 0.7
      };

      let API_KEY = "";

      let xhr = new XMLHttpRequest();
      xhr.open("POST", "https://api.openai.com/v1/chat/completions", true);
      xhr.setRequestHeader("Content-Type", "application/json");
      xhr.setRequestHeader("Authorization", "Bearer " + API_KEY);
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
          let completion = JSON.parse(xhr.responseText).choices[0].message.content;
          let promptOutput = document.createElement("p");
          promptOutput.innerHTML = "A: " + prompt;
          let completionOutput = document.createElement("p");
          completionOutput.innerHTML = "Q: " + completion;
          document.getElementById("outputContainer").appendChild(promptOutput);
          document.getElementById("outputContainer").appendChild(completionOutput);
          document.getElementById("outputContainer").scrollTop = document.getElementById("outputContainer").scrollHeight;
          document.getElementById("prompt").value = "";

          history.push({
            "role": "user",
            "content": prompt
          });
        }
      };
      xhr.send(JSON.stringify(body));
    }

    document.getElementById("prompt").addEventListener("keyup", function (event) {
      event.preventDefault();
      if (event.keyCode === 13) {
        document.getElementById("submit").click();
      }
    });
  </script>

</html>